SELECT a.*
FROM public.alumno a
JOIN ocupa rt ON a.id_alumno = rt.id_alumno
JOIN grupos g ON rt.id_grupo = g.id_grupo
WHERE g.nombre_grupo = 'dreamteam';



SELECT a.nombre as nombre_alumno, s.nombre_serie
FROM public.alumno a
JOIN alumno_recomienda_serie binaria  ON a.id_alumno = binaria.id_alumno
JOIN series s ON binaria.id_serie = s.id_serie

CONSULTA 1 - MOSTRAR POR CADA LOCALIDAD, CON EL HOBBIE MAS COMUN, LA
	CANTIADA DE ALUMNOS QUE LO PRACTICAN

SELECT 
    l.nombre_localidad,
    h.nombre_hobbie,
    COUNT(*) AS cantidad_alumnos
FROM 
    public.alumno a
JOIN 
    alumno_practica_hobbies binaria ON a.id_alumno = binaria.id_alumno
JOIN 
    hobbies h ON binaria.id_hobbie = h.id_hobbie
JOIN 
    localidades l ON a.id_localidad = l.id_localidad
GROUP BY 
    l.id_localidad, l.nombre_localidad, h.id_hobbie
ORDER BY 
    l.nombre_localidad, cantidad_alumnos DESC;
    


CONSULTA 2

SELECT 
    a.nombre,
    COUNT(ma.id_materia) AS cantidad_materias,
    CASE WHEN a.exp_sql THEN 'Sí' ELSE 'No' END AS exp_relacional,
    CASE WHEN a.exp_no_sql THEN 'Sí' ELSE 'No' END AS exp_no_relacional
FROM 
    alumno a
JOIN 
    alumno_cursa_materia ma ON a.id_alumno = ma.id_alumno
GROUP BY 
    a.id_alumno
ORDER BY 
    cantidad_materias DESC
LIMIT 10;

